<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
        "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="com.xier.sesame.attence.domain.OffLinePassword">

    <resultMap id="OffLinePasswordResultMap" type="com.xier.sesame.attence.domain.OffLinePassword">
        <result column="offline_password_id" property="offLinePasswordId" />
        <result column="org_id" property="orgId" />
        <result column="password" property="password" />
        <result column="gmt_create" property="gmtCreate" />
        <result column="gmt_modify" property="gmtModify" />
    </resultMap>

    <insert id="addOffLinePassword" parameterType="com.xier.sesame.attence.domain.OffLinePassword">

        insert into attence_offline_password(
        offline_password_id,
        org_id,
        password,
        gmt_create,
        gmt_modify
        )
        values (
        #{offLinePasswordId},
        #{orgId},
        #{password},
        now(3),
        now(3)
        )
    </insert>

    <update id="updateOffLinePassword" parameterType="com.xier.sesame.attence.domain.OffLinePassword">
        update attence_offline_password
        set
        password=#{password},
        gmt_modify = now(3)
        where
        offline_password_id = #{offLinePasswordId}
        and org_id=#{orgId}
    </update>

    <update id="updateOffLinePasswordByOrgId" parameterType="com.xier.sesame.attence.domain.OffLinePassword">
        update attence_offline_password
        set
        password=#{password},
        gmt_modify = now(3)
        where
        org_id=#{orgId}
    </update>




    <select id="getOffLinePasswordByOrgId" parameterType="com.xier.sesame.attence.domain.OffLinePassword" resultMap="OffLinePasswordResultMap">
        <include refid="sql_select"/>
        from attence_offline_password
        where
        org_id=#{orgId}
    </select>

    <select id="getOffLinePasswordById" parameterType="com.xier.sesame.attence.domain.OffLinePassword" resultMap="OffLinePasswordResultMap">
        <include refid="sql_select"/>
        from attence_offline_password
        where
        offline_password_id = #{offLinePasswordId}
        and org_id=#{orgId}
    </select>

    <select id="getOffLinePasswordByIdForUpdate" parameterType="com.xier.sesame.attence.domain.OffLinePassword" resultMap="OffLinePasswordResultMap">
        <include refid="sql_select"/>
        from attence_offline_password
        where
        offline_password_id = #{offLinePasswordId}
        and org_id=#{orgId}
        for update
    </select>

    <delete id="removeOffLinePasswordById" parameterType="com.xier.sesame.attence.domain.OffLinePassword">
        delete from attence_offline_password
        where
        offline_password_id = #{offLinePasswordId}
        and org_id=#{orgId}
    </delete>

    <select id="getOffLinePasswordCount" resultType="int" parameterType="com.xier.sesame.attence.domain.OffLinePassword" >
        select
        count(*)
        <include refid="sql_where"/>
    </select>


    <sql id="sql_where">
        from attence_offline_password
        <where>
            <if test="offLinePasswordId != null">
                offline_password_id = #{offLinePasswordId}
            </if>
            <if test="orgId != null">
                and org_id = #{orgId}
            </if>
            <if test="password != null">
                and password = #{password}
            </if>
        </where>
    </sql>

    <sql id="sql_select">
        select
        offline_password_id,
        org_id,
        password,
        gmt_create,
        gmt_modify
    </sql>
</mapper>