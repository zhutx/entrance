<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" 
"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="com.xier.sesame.attence.TimeSetting">
			
	<resultMap id="TimeSettingResultMap" type="com.xier.sesame.attence.domain.TimeSetting">
	<result column="time_setting_id" property="timeSettingId" />
	<result column="org_id" property="orgId" />
	<result column="disable_date" property="disableDate" />
	<result column="gmt_create" property="gmtCreate" />
	<result column="gmt_modify" property="gmtModify" />
	</resultMap>
	
	<insert id="addTimeSetting" parameterType="com.xier.sesame.attence.domain.TimeSetting">

		insert into attence_time_setting(
			time_setting_id,
			org_id,
			disable_date,
			gmt_create,
			gmt_modify	
		)
		values (
		 	#{timeSettingId},
			#{orgId},
			#{disableDate},
			now(3),
			now(3)
		)
	</insert>
	
	<update id="updateTimeSetting" parameterType="com.xier.sesame.attence.domain.TimeSetting">
		update attence_time_setting
		set
			disable_date=#{disableDate},
			gmt_modify = now(3)
		where
			time_setting_id = #{timeSettingId}
			and org_id=#{orgId}
	</update>
	
	<update id="updateTimeSettingSelective" parameterType="com.xier.sesame.attence.domain.TimeSetting">
		update attence_time_setting
		<set>
		<if test="disableDate != null">
			disable_date=#{disableDate},
		</if>
			gmt_modify = now(3)
		</set>
		where
			time_setting_id = #{timeSettingId}
			and org_id=#{orgId}
	</update>
   
 	<select id="getTimeSettingById" parameterType="com.xier.sesame.attence.domain.TimeSetting" resultMap="TimeSettingResultMap">
<include refid="sql_select"/>
		from attence_time_setting
		where 
			time_setting_id = #{timeSettingId}
			and org_id=#{orgId}
	</select>
	
 	<select id="getTimeSettingByIdForUpdate" parameterType="com.xier.sesame.attence.domain.TimeSetting" resultMap="TimeSettingResultMap">
<include refid="sql_select"/>
		from attence_time_setting
		where 
			time_setting_id = #{timeSettingId}
			and org_id=#{orgId}
	for update
	</select>
		
	<delete id="removeTimeSettingById" parameterType="com.xier.sesame.attence.domain.TimeSetting">
		delete from attence_time_setting
		where
		time_setting_id = #{timeSettingId}
		and org_id=#{orgId}
 	</delete>
 	
	<select id="getPaginationTimeSetting" resultMap="TimeSettingResultMap" parameterType="map" >
		<include refid="sql_select"/>			
		<include refid="sql_where"/>
			order by gmt_modify desc
			 	limit #{startRow}, #{pageSize}
	</select>
  
	<select id="getTimeSettingCount" resultType="int" parameterType="com.xier.sesame.attence.domain.TimeSetting" >
		select 
			count(*)		
<include refid="sql_where"/>
	</select>


    <select id="getTimeSetting" resultMap="TimeSettingResultMap" parameterType="com.xier.sesame.attence.domain.TimeSetting" >
		<include refid="sql_select"/>			
		<include refid="sql_where"/>
	</select>




	
	<sql id="sql_where">
	    from attence_time_setting
	    <where>
    	<if test="timeSettingId != null">
		      time_setting_id = #{timeSettingId}
		</if>
		<if test="orgId != null">
		      and org_id = #{orgId}
		</if>
		<if test="disableDate != null">
		      and disable_date = #{disableDate}
		</if>
		</where>
	</sql>  	
	
	<sql id="sql_select">
		select
			time_setting_id,
			org_id,
			disable_date,
			gmt_create,
			gmt_modify	
	</sql>  
</mapper>